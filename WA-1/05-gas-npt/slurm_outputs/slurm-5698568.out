Loading rhel8/default-amp
  Loading requirement: rhel8/slurm singularity/current rhel8/global cuda/11.4
    libpciaccess/0.16/gcc-9.4.0-6fonbj6 libiconv/1.16/gcc-9.4.0-ahebbov
    libxml2/2.9.12/gcc-9.4.0-gnknt5e ncurses/6.2/gcc-9.4.0-aiirok7
    hwloc/2.5.0/gcc-9.4.0-7sqomga libevent/2.1.12/gcc-9.4.0-hgny7cm
    numactl/2.0.14/gcc-9.4.0-52dwc6n cuda/11.4.0/gcc-9.4.0-3hnxhjt
    gdrcopy/2.2/gcc-9.4.0-e4igtfp knem/1.1.4/gcc-9.4.0-bpbxgva
    libnl/3.3.0/gcc-9.4.0-whwhrwb rdma-core/34.0/gcc-9.4.0-5eo5n2u
    ucx/1.11.1/gcc-9.4.0-lktqyl4 openmpi/4.1.1/gcc-9.4.0-epagguv
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/condabin/conda
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/bin/conda
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/bin/conda-env
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/bin/activate
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/bin/deactivate
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/etc/profile.d/conda.sh
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/etc/fish/conf.d/conda.fish
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/shell/condabin/Conda.psm1
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/shell/condabin/conda-hook.ps1
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/lib/python3.7/site-packages/xontrib/conda.xsh
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/etc/profile.d/conda.csh
no change     /home/dwl38/.bashrc
No action taken.
Changed directory to /rds/user/dwl38/hpc-work/MPhil-Scientific-Computing/WA-1/05-gas-npt.

JobID: 5698568
======
Time: Wed 26 Feb 12:19:48 GMT 2025
Running on master node: gpu-q-8
Current directory: /rds/user/dwl38/hpc-work/MPhil-Scientific-Computing/WA-1/05-gas-npt

Nodes allocated:
================
gpu-q-8

numtasks=1, numnodes=1, mpi_tasks_per_node=1 (OMP_NUM_THREADS=1)

Executing command:
==================
python run.py 700 900 1000 0; python run.py 900 1100 1000 0

Running crystal gradual heat from 700K to 900K with 1000 timesteps per degree and 0 final equilibration timesteps...
Loading MACE-MP-0 model...
Converting models to CuEq for acceleration
No dtype selected, switching to float64 to match model dtype.
Starting MD...
Running MD...
    Progress: running 701K...
    Progress: running 702K...
    Progress: running 703K...
    Progress: running 704K...
    Progress: running 705K...
    Progress: running 706K...
    Progress: running 707K...
    Progress: running 708K...
    Progress: running 709K...
    Progress: running 710K...
    Progress: running 711K...
    Progress: running 712K...
    Progress: running 713K...
    Progress: running 714K...
    Progress: running 715K...
    Progress: running 716K...
    Progress: running 717K...
    Progress: running 718K...
    Progress: running 719K...
    Progress: running 720K...
    Progress: running 721K...
    Progress: running 722K...
    Progress: running 723K...
    Progress: running 724K...
    Progress: running 725K...
    Progress: running 726K...
    Progress: running 727K...
    Progress: running 728K...
    Progress: running 729K...
    Progress: running 730K...
    Progress: running 731K...
    Progress: running 732K...
    Progress: running 733K...
    Progress: running 734K...
    Progress: running 735K...
    Progress: running 736K...
    Progress: running 737K...
    Progress: running 738K...
    Progress: running 739K...
    Progress: running 740K...
    Progress: running 741K...
    Progress: running 742K...
    Progress: running 743K...
    Progress: running 744K...
    Progress: running 745K...
    Progress: running 746K...
    Progress: running 747K...
    Progress: running 748K...
    Progress: running 749K...
    Progress: running 750K...
    Progress: running 751K...
    Progress: running 752K...
    Progress: running 753K...
    Progress: running 754K...
    Progress: running 755K...
    Progress: running 756K...
    Progress: running 757K...
    Progress: running 758K...
    Progress: running 759K...
    Progress: running 760K...
    Progress: running 761K...
    Progress: running 762K...
    Progress: running 763K...
    Progress: running 764K...
    Progress: running 765K...
    Progress: running 766K...
    Progress: running 767K...
    Progress: running 768K...
    Progress: running 769K...
    Progress: running 770K...
    Progress: running 771K...
    Progress: running 772K...
    Progress: running 773K...
    Progress: running 774K...
    Progress: running 775K...
    Progress: running 776K...
    Progress: running 777K...
    Progress: running 778K...
    Progress: running 779K...
    Progress: running 780K...
    Progress: running 781K...
    Progress: running 782K...
    Progress: running 783K...
    Progress: running 784K...
    Progress: running 785K...
    Progress: running 786K...
    Progress: running 787K...
    Progress: running 788K...
    Progress: running 789K...
    Progress: running 790K...
    Progress: running 791K...
    Progress: running 792K...
    Progress: running 793K...
    Progress: running 794K...
    Progress: running 795K...
    Progress: running 796K...
    Progress: running 797K...
    Progress: running 798K...
    Progress: running 799K...
    Progress: running 800K...
    Progress: running 801K...
    Progress: running 802K...
    Progress: running 803K...
    Progress: running 804K...
    Progress: running 805K...
    Progress: running 806K...
    Progress: running 807K...
    Progress: running 808K...
    Progress: running 809K...
    Progress: running 810K...
    Progress: running 811K...
    Progress: running 812K...
    Progress: running 813K...
    Progress: running 814K...
    Progress: running 815K...
    Progress: running 816K...
    Progress: running 817K...
    Progress: running 818K...
    Progress: running 819K...
    Progress: running 820K...
    Progress: running 821K...
    Progress: running 822K...
    Progress: running 823K...
    Progress: running 824K...
    Progress: running 825K...
    Progress: running 826K...
    Progress: running 827K...
    Progress: running 828K...
    Progress: running 829K...
    Progress: running 830K...
    Progress: running 831K...
    Progress: running 832K...
    Progress: running 833K...
    Progress: running 834K...
    Progress: running 835K...
    Progress: running 836K...
    Progress: running 837K...
    Progress: running 838K...
    Progress: running 839K...
    Progress: running 840K...
    Progress: running 841K...
    Progress: running 842K...
    Progress: running 843K...
    Progress: running 844K...
    Progress: running 845K...
    Progress: running 846K...
    Progress: running 847K...
    Progress: running 848K...
    Progress: running 849K...
    Progress: running 850K...
    Progress: running 851K...
    Progress: running 852K...
    Progress: running 853K...
    Progress: running 854K...
    Progress: running 855K...
    Progress: running 856K...
    Progress: running 857K...
    Progress: running 858K...
    Progress: running 859K...
    Progress: running 860K...
    Progress: running 861K...
    Progress: running 862K...
    Progress: running 863K...
    Progress: running 864K...
    Progress: running 865K...
    Progress: running 866K...
    Progress: running 867K...
    Progress: running 868K...
    Progress: running 869K...
    Progress: running 870K...
    Progress: running 871K...
    Progress: running 872K...
    Progress: running 873K...
    Progress: running 874K...
    Progress: running 875K...
    Progress: running 876K...
    Progress: running 877K...
    Progress: running 878K...
    Progress: running 879K...
    Progress: running 880K...
    Progress: running 881K...
    Progress: running 882K...
    Progress: running 883K...
    Progress: running 884K...
    Progress: running 885K...
    Progress: running 886K...
    Progress: running 887K...
    Progress: running 888K...
    Progress: running 889K...
    Progress: running 890K...
    Progress: running 891K...
    Progress: running 892K...
    Progress: running 893K...
    Progress: running 894K...
    Progress: running 895K...
    Progress: running 896K...
    Progress: running 897K...
    Progress: running 898K...
    Progress: running 899K...
    Progress: running 900K...
MD finished!
Wall time taken (hh:mm:ss) was 04:40:25.
Running crystal gradual heat from 900K to 1100K with 1000 timesteps per degree and 0 final equilibration timesteps...
Loading MACE-MP-0 model...
Converting models to CuEq for acceleration
No dtype selected, switching to float64 to match model dtype.
Starting MD...
Running MD...
    Progress: running 901K...
    Progress: running 902K...
    Progress: running 903K...
    Progress: running 904K...
    Progress: running 905K...
    Progress: running 906K...
    Progress: running 907K...
    Progress: running 908K...
    Progress: running 909K...
    Progress: running 910K...
    Progress: running 911K...
    Progress: running 912K...
    Progress: running 913K...
    Progress: running 914K...
    Progress: running 915K...
    Progress: running 916K...
    Progress: running 917K...
    Progress: running 918K...
    Progress: running 919K...
    Progress: running 920K...
    Progress: running 921K...
    Progress: running 922K...
    Progress: running 923K...
    Progress: running 924K...
    Progress: running 925K...
    Progress: running 926K...
    Progress: running 927K...
    Progress: running 928K...
    Progress: running 929K...
    Progress: running 930K...
    Progress: running 931K...
    Progress: running 932K...
    Progress: running 933K...
    Progress: running 934K...
    Progress: running 935K...
    Progress: running 936K...
    Progress: running 937K...
    Progress: running 938K...
    Progress: running 939K...
    Progress: running 940K...
    Progress: running 941K...
    Progress: running 942K...
    Progress: running 943K...
    Progress: running 944K...
    Progress: running 945K...
    Progress: running 946K...
    Progress: running 947K...
    Progress: running 948K...
    Progress: running 949K...
    Progress: running 950K...
    Progress: running 951K...
    Progress: running 952K...
    Progress: running 953K...
    Progress: running 954K...
    Progress: running 955K...
    Progress: running 956K...
    Progress: running 957K...
    Progress: running 958K...
    Progress: running 959K...
    Progress: running 960K...
    Progress: running 961K...
    Progress: running 962K...
    Progress: running 963K...
    Progress: running 964K...
    Progress: running 965K...
    Progress: running 966K...
    Progress: running 967K...
    Progress: running 968K...
    Progress: running 969K...
    Progress: running 970K...
    Progress: running 971K...
    Progress: running 972K...
    Progress: running 973K...
    Progress: running 974K...
    Progress: running 975K...
    Progress: running 976K...
    Progress: running 977K...
    Progress: running 978K...
    Progress: running 979K...
    Progress: running 980K...
    Progress: running 981K...
    Progress: running 982K...
    Progress: running 983K...
    Progress: running 984K...
    Progress: running 985K...
    Progress: running 986K...
    Progress: running 987K...
    Progress: running 988K...
    Progress: running 989K...
    Progress: running 990K...
    Progress: running 991K...
    Progress: running 992K...
    Progress: running 993K...
    Progress: running 994K...
    Progress: running 995K...
    Progress: running 996K...
    Progress: running 997K...
    Progress: running 998K...
    Progress: running 999K...
    Progress: running 1000K...
    Progress: running 1001K...
    Progress: running 1002K...
    Progress: running 1003K...
    Progress: running 1004K...
    Progress: running 1005K...
    Progress: running 1006K...
    Progress: running 1007K...
    Progress: running 1008K...
    Progress: running 1009K...
    Progress: running 1010K...
    Progress: running 1011K...
    Progress: running 1012K...
    Progress: running 1013K...
    Progress: running 1014K...
    Progress: running 1015K...
    Progress: running 1016K...
    Progress: running 1017K...
    Progress: running 1018K...
Traceback (most recent call last):
  File "/rds/user/dwl38/hpc-work/MPhil-Scientific-Computing/WA-1/05-gas-npt/run.py", line 66, in <module>
    dyn.run(steps_per_degree)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/ase/md/npt.py", line 284, in run
    self.step()
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/ase/md/npt.py", line 354, in step
    force = self.forcecalculator()
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/ase/md/npt.py", line 362, in forcecalculator
    return self.atoms.get_forces(md=True)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/ase/atoms.py", line 827, in get_forces
    forces = self._calc.get_forces(self)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/ase/calculators/abc.py", line 30, in get_forces
    return self.get_property('forces', atoms)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/ase/calculators/calculator.py", line 538, in get_property
    self.calculate(atoms, [name], system_changes)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/mace/calculators/mace.py", line 304, in calculate
    out = model(
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/mace/modules/models.py", line 412, in forward
    node_feats, sc = interaction(
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/mace/modules/blocks.py", line 668, in forward
    mji = self.conv_tp(
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/mace/modules/wrapper_ops.py", line 157, in cuet_forward
    return self.original_forward(x, y, z, use_fallback=None)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/cuequivariance_torch/operations/tp_channel_wise.py", line 150, in forward
    return self.f(weight, x1, x2, use_fallback=use_fallback)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/cuequivariance_torch/primitives/equivariant_tensor_product.py", line 168, in forward
    output = self.tp(*inputs, use_fallback=use_fallback)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/cuequivariance_torch/primitives/tensor_product.py", line 97, in forward
    return self.f_cuda(*args)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/cuequivariance_torch/primitives/tensor_product.py", line 625, in forward
    out = self._f(x0, x1, x2)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/cuequivariance_ops_torch/tensor_product_uniform_1d.py", line 573, in forward
    out = tensor_product_uniform_1d_fwd(
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/cuequivariance_ops_torch/tensor_product_uniform_1d.py", line 339, in tensor_product_uniform_1d_fwd
    return torch.ops.cuequivariance_ops_torch.tensor_product_uniform_4x1d_fwd_primitive(
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/torch/_ops.py", line 1123, in __call__
    return self._op(*args, **(kwargs or {}))
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/torch/_library/autograd.py", line 111, in autograd_impl
    result = Generated.apply(*args, Metadata(keyset, keyword_only_args))  # type: ignore[attr-defined]
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/torch/autograd/function.py", line 575, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/torch/_library/autograd.py", line 50, in forward
    result = op.redispatch(keyset & _C._after_autograd_keyset, *args, **kwargs)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/torch/_ops.py", line 728, in redispatch
    return self._handle.redispatch_boxed(keyset, *args, **kwargs)
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/cuequivariance_ops_torch/tensor_product_uniform_1d.py", line 228, in _
    return _fwd_impl(
  File "/home/dwl38/.conda/envs/venv/lib/python3.10/site-packages/cuequivariance_ops_torch/tensor_product_uniform_1d.py", line 45, in _fwd_impl
    ext.tensor_product_uniform_1d_fwd(
RuntimeError: kernel launch failed
